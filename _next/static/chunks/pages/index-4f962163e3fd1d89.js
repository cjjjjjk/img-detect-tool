(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1642:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_c7f111",variable:"__variable_c7f111"}},6760:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7944)}])},7798:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_acdfbd",variable:"__variable_acdfbd"}},7944:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var l=a(7876),n=a(4232),r=a(7798),s=a.n(r),c=a(1642),i=a.n(c);let d=(0,n.forwardRef)((e,t)=>{let{onFileSelect:a,isWidthCollapsed:r}=e,[s,c]=(0,n.useState)(!1),[i,d]=(0,n.useState)(0),[o,u]=(0,n.useState)(r),[x,h]=(0,n.useState)([]),[m,p]=(0,n.useState)(1),[f,b]=(0,n.useState)(null),g=Math.ceil(x.length/50),y=(m-1)*50,v=(0,n.useMemo)(()=>x.slice(y,y+50),[x,m]),w=e=>{let t=(e-1)*50;p(e),b(t),a(x[t])};(0,n.useImperativeHandle)(t,()=>({nextImage(){if(null!=f)if(f===y+50-1){if(m<g){let e=m+1,t=(e-1)*50;p(e),N(x[t],t)}}else N(v[f-y+1],f+1)},prevImage(){if(null!=f)if(f===y){if(m>1){let e=m-1,t=Math.min((e-1)*50+50-1,x.length-1);p(e),N(x[t],t)}}else N(v[f-y-1],f-1)}})),(0,n.useEffect)(()=>{x.length&&u(r)},[r]);let j=async e=>{if(!e)return;c(!0),d(0);let t=0,a=Array.from(e).filter(e=>e.type.startsWith("image/")),l=setInterval(()=>{t<80&&d(t+=2)},100);try{await new Promise(e=>setTimeout(e,2e3)),clearInterval(l),d(100),setTimeout(()=>{c(!1),h(e=>[...e,...a]),p(1)},500)}catch(e){clearInterval(l),c(!1)}finally{N(a[0],0)}},N=(e,t)=>{null!=t&&b(t),a(e)};return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"border border-dashed border-gray-400 px-3 py-2 rounded-xl",onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),j(e.dataTransfer.files)},onClick:()=>{var e;return null==(e=document.getElementById("fileInput"))?void 0:e.click()},children:[(0,l.jsx)("input",{id:"fileInput",type:"file",accept:"image/*",multiple:!0,webkitdirectory:"true",className:"hidden",onChange:e=>j(e.target.files)}),(0,l.jsx)("p",{className:"text-gray-600",children:"select folder"})]}),s?(0,l.jsxs)("div",{className:"mt-4 p-4 text-center",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-2",children:"uploading..."}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-in-out",style:{width:"".concat(i,"%")}})}),(0,l.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:[i,"%"]})]}):x.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"mt-4 flex flex-col gap-2 max-h-[70vh] overflow-y-auto px-3",children:v.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between cursor-pointer hover:bg-white/40 ".concat(y+t==f?"border border-red-400":""),onClick:()=>N(e,y+t),children:[(0,l.jsx)("div",{className:"flex items-center gap-2 flex-1 overflow-hidden",children:(0,l.jsx)("span",{className:"text-sm truncate",children:e.name})}),!o&&(0,l.jsx)("span",{className:"text-xs shrink-0 bg-orange-400 text-white rounded-sm px-1 font-bold",children:(e=>{let t=e.split(".");return t.length>1?".".concat(t.pop()):""})(e.name)}),!o&&(0,l.jsx)("button",{className:"ml-2 px-2 py-1 text-black text-xs rounded hover:text-red-500 hover:cursor-pointer",onClick:e=>{var a;e.stopPropagation(),a=y+t,h(e=>e.filter((e,t)=>t!==a)),m>Math.ceil((x.length-1)/50)&&p(Math.max(1,m-1))},children:"X"})]},y+t))}),g>1&&(0,l.jsxs)("div",{className:"mt-4 flex justify-center items-center",children:[(0,l.jsx)("button",{onClick:()=>w(m-1),disabled:1===m,className:"px-2 py-1 mx-1 rounded bg-gray-200 disabled:opacity-50",children:"◀"}),(()=>{let e=[],t=Math.max(1,m-Math.floor(2.5)),a=Math.min(g,t+5-1);a-t+1<5&&(t=Math.max(1,a-5+1));for(let n=t;n<=a;n++)e.push((0,l.jsx)("button",{onClick:()=>w(n),className:"h-8 w-8 rounded-full mx-1 ".concat(m===n?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:n},n));return e})(),(0,l.jsx)("button",{onClick:()=>w(m+1),disabled:m===g,className:"px-2 py-1 mx-1 rounded bg-gray-200 disabled:opacity-50",children:"▶"})]})]}):null]})});function o(e){let{imgData:t}=e,[a,r]=(0,n.useState)([]),[s,c]=(0,n.useState)(!1),[i,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{t&&r(e=>{let a=e.findIndex(e=>e.name===t.name);if(-1===a)return[...e,t];{let l=[...e];return l[a]=t,l}})},[t]);let o=e=>{d(e),c(!0)};return(0,l.jsxs)("div",{className:"p-4 border rounded mt-4 overflow-hidden",children:[(0,l.jsx)("h2",{className:"font-semibold mb-2",children:"Output Data"}),(0,l.jsxs)("table",{className:"w-full border text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-100",children:[(0,l.jsx)("th",{className:"border px-2",children:"Name"}),(0,l.jsx)("th",{className:"border px-2",children:"X"}),(0,l.jsx)("th",{className:"border px-2",children:"Y"}),(0,l.jsx)("th",{className:"border px-2",children:"W"}),(0,l.jsx)("th",{className:"border px-2",children:"H"}),(0,l.jsx)("th",{className:"border px-2 py-1"})]})}),(0,l.jsx)("tbody",{children:a.map((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border px-2",children:e.name}),(0,l.jsx)("td",{className:"border px-2",children:e.x}),(0,l.jsx)("td",{className:"border px-2",children:e.y}),(0,l.jsx)("td",{className:"border px-2",children:e.w}),(0,l.jsx)("td",{className:"border px-2",children:e.h}),(0,l.jsx)("td",{className:"border px-2 py-1 text-center",children:(0,l.jsx)("button",{className:"bg-red-500 text-white px-2 py-1 rounded",onClick:()=>{r(e=>e.filter((e,a)=>a!==t))},children:"Del"})})]},t))})]}),(0,l.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>o("csv"),className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Export CSV"}),(0,l.jsx)("button",{onClick:()=>o("txt"),className:"px-3 py-1 bg-green-600 text-white rounded",children:"Export TXT"})]}),s&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"bg-white p-4 rounded w-[400px]",children:[(0,l.jsxs)("h3",{className:"font-semibold mb-2",children:["Preview (",null==i?void 0:i.toUpperCase(),")"]}),(0,l.jsx)("pre",{className:"bg-gray-100 p-2 rounded h-[200px] overflow-auto text-xs",children:"csv"===i?"name,x,y,w,h\n"+a.map(e=>"".concat(e.name,",").concat(e.x,",").concat(e.y,",").concat(e.w,",").concat(e.h)).join("\n"):a.map(e=>"name=".concat(e.name," x=").concat(e.x," y=").concat(e.y," w=").concat(e.w," h=").concat(e.h)).join("\n")}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,l.jsx)("button",{onClick:()=>c(!1),className:"px-3 py-1 bg-gray-400 text-white rounded",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{if(!i)return;let e="";"csv"===i?e="name,x,y,w,h\n"+a.map(e=>"".concat(e.name,",").concat(e.x,",").concat(e.y,",").concat(e.w,",").concat(e.h)).join("\n"):"txt"===i&&(e=a.map(e=>"name=".concat(e.name," x=").concat(e.x," y=").concat(e.y," w=").concat(e.w," h=").concat(e.h)).join("\n"));let t=new Blob([e],{type:"text/plain;charset=utf-8"}),l=URL.createObjectURL(t),n=document.createElement("a");n.href=l,n.download="export_".concat(Math.floor(100*Math.random()),".").concat(i),n.click(),URL.revokeObjectURL(l),c(!1)},className:"px-3 py-1 bg-blue-600 text-white rounded",children:"Download"})]})]})})]})}function u(e){let{file:t,onDataOutput:a}=e,r=(0,n.useRef)(null),s=(0,n.useRef)(null),c=(0,n.useRef)(null),[i,d]=(0,n.useState)(null),[o,u]=(0,n.useState)(null),[x,h]=(0,n.useState)({naturalW:1,naturalH:1,displayW:1,displayH:1}),m=t?URL.createObjectURL(t):null;return(0,n.useEffect)(()=>{u(null)},[t]),(0,n.useEffect)(()=>{if(!o)return;let e=x.displayW/x.naturalW,t=x.displayH/x.naturalH;u({...o,x:Math.round(o.realX*e),y:Math.round(o.realY*t),w:Math.round(o.realW*e),h:Math.round(o.realH*t)})},[x]),(0,l.jsx)("div",{ref:r,className:"tool-container relative border border-dashed p-4 rounded h-[90%] bg-gray-100/80",onMouseDown:e=>{if(!t||!s.current)return;let a=s.current.getBoundingClientRect(),l=e.clientX-a.left,n=e.clientY-a.top;l<0&&(l=0),n<0&&(n=0),l>a.width&&(l=a.width),n>a.height&&(n=a.height),d({x:l,y:n}),u({x:l,y:n,w:0,h:0,realX:0,realY:0,realW:0,realH:0})},onMouseMove:e=>{if(!i||!t)return;let{x:a,y:l}=((e,t)=>{if(!s.current)return{x:0,y:0};let a=s.current.getBoundingClientRect();return{x:Math.max(0,Math.min(a.width,e-a.left)),y:Math.max(0,Math.min(a.height,t-a.top))}})(e.clientX,e.clientY),n=Math.abs(a-i.x),r=Math.abs(l-i.y),c=Math.min(i.x,a),d=Math.min(i.y,l),o=x.naturalW/x.displayW,h=x.naturalH/x.displayH;u({x:c,y:d,w:n,h:r,realX:Math.round(c*o),realY:Math.round(d*h),realW:Math.round(n*o),realH:Math.round(r*h)})},onMouseUp:()=>{if(o&&t){let e=Math.min(o.realX,o.realX+o.realW),l=Math.min(o.realY,o.realY+o.realH),n=Math.abs(o.realW),r=Math.abs(o.realH);console.log({name:t.name,x:e,y:l,w:n,h:r}),a({name:t.name,x:e,y:l,w:n,h:r}),u({...o,realX:e,realY:l,realW:n,realH:r,x:Math.min(o.x,o.x+o.w),y:Math.min(o.y,o.y+o.h),w:Math.abs(o.w),h:Math.abs(o.h)})}d(null)},children:t?(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"mt-2 text-sm text-center truncate flex",children:[t.name,(0,l.jsx)("span",{className:"absolute top-0 left-0 bg-amber-300 text-black text-[10px] px-1",children:"h:".concat(x.naturalH," w:").concat(x.naturalW)})]}),(0,l.jsxs)("div",{ref:s,className:"relative border w-fit min-w-[80vh] border-gray-300",children:[(0,l.jsx)("img",{ref:c,src:m||"",alt:t.name,onLoad:()=>{if(c.current){let e={naturalW:c.current.naturalWidth,naturalH:c.current.naturalHeight,displayW:c.current.clientWidth,displayH:c.current.clientHeight};h(t=>t.naturalW===e.naturalW&&t.naturalH===e.naturalH&&t.displayW===e.displayW&&t.displayH===e.displayH?t:e)}},className:"w-full min-h-[100%] max-h-[100%] object-contain rounded pointer-events-none"}),o&&(0,l.jsx)("div",{className:"absolute border-2 border-red-500 bg-red-500/20",style:{left:o.x,top:o.y,width:o.w,height:o.h},children:(0,l.jsxs)("span",{className:"absolute top-0 left-0 bg-red-600 text-white text-[10px] px-1",children:["x:",o.realX,", y:",o.realY,", w:",o.realW,", h:",o.realH]})})]})]}):(0,l.jsx)("div",{className:"p-4 border w-[100%] text-gray-500",children:"no img select"})})}function x(){let[e,t]=(0,n.useState)(250),[a,r]=(0,n.useState)(300),[c,x]=(0,n.useState)(!1),h=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=e=>{if(c&&h.current){let t=h.current.getBoundingClientRect().right-e.clientX;t>250&&t<600&&r(t)}},t=()=>x(!1);return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),window.addEventListener("mouseleave",t),window.addEventListener("blur",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t),window.removeEventListener("mouseleave",t),window.removeEventListener("blur",t)}},[c]);let[m,p]=(0,n.useState)(null),[f,b]=(0,n.useState)(null),g=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=e=>{var t,a;"Space"!==e.code||e.ctrlKey||(console.log("next"),e.preventDefault(),null==(t=g.current)||t.nextImage()),"Space"===e.code&&e.ctrlKey&&(e.preventDefault(),null==(a=g.current)||a.prevImage())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,n.useEffect)(()=>{console.log("Oke",f)},[f]),(0,l.jsxs)("div",{ref:h,className:"".concat(s().className," ").concat(i().className," font-sans flex h-screen"),children:[(0,l.jsxs)("div",{style:{width:e},className:"bg-gray-300 transition-all duration-300",children:[(0,l.jsx)("button",{onClick:()=>t(100===e?300:100),className:"p-2 bg-gray-500 text-white",children:100===e?">>":"<<"}),e>0&&(0,l.jsx)("div",{className:"p-2",children:(0,l.jsx)(d,{ref:g,onFileSelect:p,isWidthCollapsed:100===e})})]}),(0,l.jsxs)("div",{className:"flex-1 bg-white p-2 flex flex-col gap-2",children:[(0,l.jsx)(u,{file:m,onDataOutput:b}),(0,l.jsx)("div",{className:"mt-2 p-2 border border-gray-400 rounded bg-gray-50 text-sm text-gray-700",children:(0,l.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)("kbd",{className:"px-2 py-1 bg-gray-200 rounded",children:"Space"}),":next image"]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("kbd",{className:"px-2 py-1 bg-gray-200 rounded",children:"Ctrl + Space"}),":previous image"]})]})})]}),(0,l.jsxs)("div",{style:{width:a},className:"relative bg-gray-300",children:[(0,l.jsx)("div",{className:"p-2",children:(0,l.jsx)(o,{imgData:f})}),(0,l.jsx)("div",{onMouseDown:()=>x(!0),className:"absolute left-0 top-0 h-full w-1 cursor-col-resize bg-transparent hover:bg-gray-400"})]})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);